import numpy as np
import tensorflow as tf

# 1. Load model TFLite
interpreter = tf.lite.Interpreter(model_path="model_klasifikasi.tflite")
interpreter.allocate_tensors()

# 2. Ambil info input dan output
input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()

# 3. Siapkan data uji (harus bentuk [1, 63] dan sudah dinormalisasi!)
# Misal: data dari 1 baris CSV
data_uji = np.array([[0.4406284987926483,0.8529372215270996,2.78625975624891e-07,0.596922755241394,0.8037662506103516,-0.10197380185127258,0.6864909529685974,0.6506822109222412,-0.1288713663816452,0.6390724182128906,0.48629534244537354,-0.14371947944164276,0.5066332817077637,0.44211772084236145,-0.15759067237377167,0.6047834157943726,0.4448935389518738,-0.05950211361050606,0.5930811166763306,0.24521562457084656,-0.0781642496585846,0.5704202651977539,0.12334626913070679,-0.09086700528860092,0.5525826215744019,0.03513404726982117,-0.10517409443855286,0.4997771978378296,0.43433383107185364,-0.035637326538562775,0.4666984975337982,0.23636025190353394,-0.0681171789765358,0.46636316180229187,0.3011073172092438,-0.08269041031599045,0.4872969090938568,0.3781109154224396,-0.08055280894041061,0.40603312849998474,0.4490697979927063,-0.021055640652775764,0.37428057193756104,0.272219181060791,-0.061223093420267105,0.38959160447120667,0.3296882212162018,-0.07260540872812271,0.40581050515174866,0.4230768084526062,-0.06756927073001862,0.312872052192688,0.4927911162376404,-0.016076335683465004,0.2831323742866516,0.3522057831287384,-0.05830566957592964,0.31050682067871094,0.36297091841697693,-0.07116270065307617,0.3373829126358032,0.436699241399765,-0.07018449157476425]], dtype=np.float32)

# 4. Set input tensor
interpreter.set_tensor(input_details[0]['index'], data_uji)

# 5. Jalankan inferensi
interpreter.invoke()

# 6. Ambil hasil output (probabilitas kelas)
output = interpreter.get_tensor(output_details[0]['index'])
predicted_class = np.argmax(output)

print("Kelas hasil prediksi:", predicted_class)
